version: 1
backend:
  phases:
    build:
      commands:
        - echo "Building enhanced merchant management system backend..."
        - npm install -g @aws-amplify/cli
        - amplify configure --usage-data-off
        - echo "Backend build completed"
frontend:
  phases:
    preBuild:
      commands:
        - echo "Installing dependencies for merchant management system..."
        - echo "Verifying merchant API configuration..."
        - ls -la src/utils/
        - echo "Checking merchant management pages..."
        - ls -la src/pages/
    build:
      commands:
        - echo "Building merchant management frontend..."
        - echo "Copying static assets..."
        - mkdir -p dist
        - cp -r src/* dist/
        - cp -r assets/* dist/ 2>/dev/null || echo "No assets directory found"
        - echo "Creating index.html redirect..."
        - echo '<!DOCTYPE html><html><head><meta http-equiv="refresh" content="0; url=pages/merchant-management.html"><title>Merchant Management System</title></head><body><p>Redirecting to <a href="pages/merchant-management.html">Merchant Management</a>...</p></body></html>' > dist/index.html
        - echo "Build completed successfully"
    postBuild:
      commands:
        - echo "Post-build optimizations..."
        - echo "Merchant Management System deployed successfully!"
        - echo "Available pages:"
        - echo "- /pages/merchant-management.html (Main admin dashboard)"
        - echo "- /pages/merchant-test.html (Test interface)"
        - echo "- /pages/dashboard.html (General dashboard)"
  artifacts:
    baseDirectory: dist
    files:
      - '**/*'
  cache:
    paths: []