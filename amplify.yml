version: 1
backend:
  phases:
    build:
      commands:
        - echo "Backend build phase - no backend changes needed"
frontend:
  phases:
    preBuild:
      runtime-versions:
        nodejs: 18
      commands:
        - echo "Installing dependencies..."
        - npm ci --only=production
    build:
      commands:
        - echo "Building application..."
        - echo "Creating build directory..."
        - mkdir -p public
        - echo "Copying root files..."
        - cp index.html public/
        - cp login-aws-native.html public/
        - echo "Copying assets directory..."
        - cp -r assets public/
        - echo "Copying src directory using rsync and excluding index.html..."
        - rsync -av --exclude 'index.html' src/ public/
        - echo "Listing public directory contents for verification..."
        - ls -la public
        - echo "Build completed"
    postBuild:
      commands:
        - echo "Post-build verification..."
        - ls -la public/
        - echo "Centralized Platform built and ready for deployment!"
  artifacts:
    baseDirectory: public
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*