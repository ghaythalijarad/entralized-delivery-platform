version: 1
backend:
  phases:
    preBuild:
      commands:
        - echo "ğŸš€ Installing Python dependencies for FastAPI backend..."
        - cd fastapi-template
        - python3 -m pip install --upgrade pip
        - pip3 install -r ../requirements.txt
        - echo "ğŸ”§ Setting up production environment..."
        - |
          # Copy production environment if it doesn't exist
          if [ ! -f ".env" ]; then
            cp .env.production .env
            echo "âœ… Production environment configured"
          fi
    build:
      commands:
        - echo "ğŸ—ï¸ Initializing production database and application..."
        - export ENVIRONMENT=production
        - python3 -c "
          try:
              from app.database import engine
              from app.models import Base
              Base.metadata.create_all(bind=engine)
              print('âœ… Database tables created successfully')
          except Exception as e:
              print(f'âš ï¸ Database setup: {e}')
          "
        - echo "âœ… Backend build completed successfully"
    postBuild:
      commands:
        - echo "ğŸ¯ Preparing application for deployment..."
        - python3 -c "
          import os
          print('ğŸŒ Environment:', os.environ.get('ENVIRONMENT', 'development'))
          print('ğŸ” Debug mode:', os.environ.get('DEBUG', 'true'))
          print('ğŸš€ Application ready for production!')
          "
frontend:
  phases:
    preBuild:
      commands:
        - echo "ğŸ“ Preparing frontend static files..."
        - cd fastapi-template
    build:
      commands:
        - echo "ğŸŒ Frontend files ready for serving"
        - ls -la static/
  artifacts:
    baseDirectory: fastapi-template
    files:
      - '**/*'
    name: centralized-delivery-platform
  cache:
    paths: []